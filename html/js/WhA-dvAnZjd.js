self.CavalryLogger&&CavalryLogger.start_js(["+dz/z"]),__d("PageLikeButtonLazy",["Arbiter","Bootloader","Event","PageLikeConstants","SubscriptionsHandler","ifRequired","setImmediate"],function(t,e,i,o,s,n){var u=new(e("SubscriptionsHandler")),r=[],h=!1,l=!1,a=e("PageLikeConstants").LIKED,d=e("PageLikeConstants").UNLIKED,c=e("PageLikeConstants").SPM_CALLOUT,y=e("PageLikeConstants").LAZY_CLICK,_={init:function(){for(var t=arguments.length,i=Array(t),o=0;o<t;o++)i[o]=arguments[o];e("ifRequired")("PageLikeButton",function(t){return t.init.apply(t,i)},function(){i[11]=babelHelpers["extends"]({},i[11],{isLazy:!0}),this._startListening(i[1]),r.push(i)}.bind(this))},_startListening:function(t){h||(h=!0,u.addSubscriptions(e("Arbiter").subscribe([a,d,c],function(t,i){e("Arbiter").inform(t+".lazy",i,e("Arbiter").BEHAVIOR_PERSISTENT),this._bootload()}.bind(this)))),u.addSubscriptions(e("Event").listen(t,"click",function(i){e("Arbiter").inform(y,{event:i,node:t},e("Arbiter").BEHAVIOR_PERSISTENT),e("setImmediate")(function(){return this._bootload()}.bind(this))}.bind(this)))},_bootload:function(){l||(l=!0,e("Bootloader").loadModules(["PageLikeButton"],function(t){u.release(),r.forEach(function(e){return t.init.apply(t,e)})},"PageLikeButtonLazy"))}};s.exports=_},null),__d("HoverButton",["csx","cx","AsyncRequest","CSS","DOM","URI"],function(t,e,i,o,s,n,u,r){function h(t,e,i,o){"use strict";this._button=t,this._flyout=e,this._flyoutAjaxify=o,this._flyoutContent=i,e.subscribe("show",this._onShow.bind(this)),e.subscribe("hide",this._onHide.bind(this))}h.prototype.showFlyoutBriefly=function(){"use strict";this.showFlyout(),this._flyout.hideFlyoutDelayed(5e3)},h.prototype.showFlyout=function(){"use strict";this._flyout.showFlyout(this._button,!0),this._flyout.inform("show",this._button)},h.prototype.hideFlyout=function(){"use strict";this._flyout.hideFlyout(!0),this._flyout.inform("hide",this._button)},h.prototype.enableButton=function(){"use strict";this._flyout.initNode(this._button)},h.prototype.disableButton=function(){"use strict";this.hideFlyout(),this._flyout.deactivateNode(this._button)},h.prototype._onShow=function(t,i){"use strict";e("CSS").addClass(i,"_52nd"),(e("CSS").hasClass(i,"uiButton")||e("CSS").matchesSelector(i,"._42fu"))&&e("CSS").addClass(i,"selected"),this._flyoutAjaxify&&(e("CSS").addClass(this._flyoutContent,"async_saving"),(new(e("AsyncRequest"))).setURI(new(e("URI"))(this._flyoutAjaxify)).setHandler(function(t){e("CSS").removeClass(this._flyoutContent,"async_saving"),e("DOM").setContent(this._flyoutContent,t.payload)}.bind(this)).send(),this._flyoutAjaxify=null)},h.prototype._onHide=function(t,i){"use strict";e("CSS").removeClass(i,"_52nd"),(e("CSS").hasClass(i,"uiButton")||e("CSS").matchesSelector(i,"._42fu"))&&e("CSS").removeClass(i,"selected")},h.prototype.destroy=function(){"use strict";this.hideFlyout(),this._flyout.destroy()},h.prototype.suppressNextMouseEnter=function(){"use strict";this._flyout.setActiveNode(this._button)},Object.assign(h.prototype,{_button:null,_flyout:null,_flyoutAjaxify:null,_flyoutContent:null}),s.exports=h},null),__d("HoverFlyout",["Arbiter","ArbiterMixin","DataStore","Event","Keys","arrayContains","mixin","removeFromArray","shield"],function(t,e,i,o,s,n){function u(t,i,o,s){"use strict";h.constructor.call(this),t&&(this._showDelay=o,this._hideDelay=s,this.init(t),i&&this.initNode(i)),e("Arbiter").subscribe("SwapButtonDEPRECATED/focusOnJoinButton",e("shield")(this.hideFlyout,this),e("Arbiter").SUBSCRIBE_ALL)}var r,h;r=babelHelpers.inherits(u,e("mixin")(e("ArbiterMixin"))),h=r&&r.prototype,u.prototype.init=function(t){"use strict";return this._flyout=t,this._showDelay=this._showDelay||0,this._hideDelay=this._hideDelay||100,this._showTimeout=null,this._hideTimeout=null,this._flyoutSubscriptions=[this._flyout.subscribe("mouseenter",this._onFlyoutMouseEnter.bind(this)),this._flyout.subscribe("mouseleave",e("shield")(this.hideFlyout,this))],this._nodes=[],this._dataStoreUnique="HoverFlyout_"+Date.now()+"_listeners",this},u.prototype.initNode=function(t){"use strict";return e("arrayContains")(this._nodes,t)?this:(this._nodes.push(t),e("DataStore").set(t,this._dataStoreUnique,[e("Event").listen(t,"mouseenter",this._onNodeMouseEnter.bind(this,t)),e("Event").listen(t,"mouseleave",e("shield")(this.hideFlyout,this)),e("Event").listen(t,"click",this._onNodeMouseEnter.bind(this,t)),e("Event").listen(t,"keydown",this._onNodeKeyEscape.bind(this))]),this)},u.prototype.deactivateNode=function(t){"use strict";var i=e("DataStore").get(t,this._dataStoreUnique);if(i)for(;i.length;)i.pop().remove();e("removeFromArray")(this._nodes,t)},u.prototype.setShowDelay=function(t){"use strict";return this._showDelay=t,this},u.prototype.setHideDelay=function(t){"use strict";return this._hideDelay=t,this},u.prototype.showFlyout=function(t,e){"use strict";return this.setActiveNode(t),e?(this._flyout.setContext(t).show(),this.inform("show",t)):this._showTimeout=setTimeout(this.showFlyout.bind(this,t,!0),this._showDelay),this},u.prototype.hideFlyout=function(t){"use strict";clearTimeout(this._showTimeout),t?(this._flyout.hide(),this._activeNode&&this.inform("hide",this._activeNode),this._activeNode=null):this._hideTimeout=setTimeout(this.hideFlyout.bind(this,!0),this._hideDelay)},u.prototype.hideFlyoutDelayed=function(t){"use strict";clearTimeout(this._showTimeout),clearTimeout(this._hideTimeout),this._hideTimeout=setTimeout(this.hideFlyout.bind(this,!0),t)},u.prototype.getActiveNode=function(){"use strict";return this._activeNode},u.prototype.setActiveNode=function(t){"use strict";return clearTimeout(this._hideTimeout),this._activeNode&&this._activeNode!==t&&this.hideFlyout(!0),this._activeNode=t,this},u.prototype.clearNodes=function(){"use strict";for(var t=this._nodes.length;t>0;t--)this.deactivateNode(this._nodes[t-1])},u.prototype.destroy=function(){"use strict";for(;this._flyoutSubscriptions.length;)this._flyout.unsubscribe(this._flyoutSubscriptions.pop());this.clearNodes()},u.prototype._onNodeMouseEnter=function(t){"use strict";this._activeNode===t?clearTimeout(this._hideTimeout):this.showFlyout(t)},u.prototype._onFlyoutMouseEnter=function(){"use strict";clearTimeout(this._hideTimeout)},u.prototype._onNodeKeyEscape=function(t){"use strict";e("Event").getKeyCode(t)===e("Keys").ESC&&(this._activeNode&&this.inform("hide",this._activeNode),this._activeNode=null)},s.exports=t.HoverFlyout||u},null);
//# sourceMappingURL=maps/WhA-dvAnZjd.js.map
